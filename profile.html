<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Profile - EliteTresses</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
  <style>
    *{box-sizing:border-box;margin:0;padding:0;}
    body{font-family:'Poppins',sans-serif;background:#f4f1ee;color:#333;}

    .container{max-width:1000px;margin:40px auto;padding:0 20px;}

    /* Profile Header */
    .profile-header{
      display:flex;align-items:center;background: linear-gradient(135deg,#f7dada,#ffe5e0);padding:25px;border-radius:16px;box-shadow:0 6px 25px rgba(0,0,0,0.08);margin-bottom:25px;
    }
    .avatar{
      width:100px;height:100px;border-radius:50%;background:#817979;color:#fff;font-size:40px;display:flex;align-items:center;justify-content:center;flex-shrink:0;overflow:hidden;
      cursor:pointer;transition: transform 0.3s;
    }
    .avatar:hover{transform:scale(1.05);}
    .avatar img{width:100%;height:100%;object-fit:cover;}
    .profile-info{margin-left:25px;}
    .profile-info h1{font-size:26px;font-weight:600;margin-bottom:6px;color:#5e3c3c;}
    .profile-info p{font-size:14px;color:#444;margin-bottom:10px;}
    .buttons{display:flex;gap:12px;}
    .btn{padding:10px 16px;border-radius:8px;border:none;cursor:pointer;font-weight:600;transition:0.3s;}
    .btn-primary{background:#817979;color:#fff;}
    .btn-primary:hover{background:#5e3c3c;}
    .btn-secondary{background:#f1f1f1;color:#333;}
    .btn-secondary:hover{background:#ddd;}

    /* Profile Details */
    .profile-details{
      display:grid;grid-template-columns:1fr 1fr;gap:20px;margin-bottom:25px;
    }
    .detail-card{background:#fff;padding:20px;border-radius:12px;box-shadow:0 6px 20px rgba(0,0,0,0.08);transition: transform 0.3s;}
    .detail-card:hover{transform: translateY(-5px);}
    .detail-card strong{display:block;margin-bottom:5px;color:#5e3c3c;}
    .detail-card span{font-size:14px;color:#444;}

    /* Summary Cards */
    .summary{display:flex;gap:20px;margin-bottom:25px;}
    .summary-card{flex:1;background:linear-gradient(135deg,#ffd6d6,#fff0f0);padding:20px;border-radius:12px;box-shadow:0 6px 20px rgba(0,0,0,0.08);text-align:center;transition: transform 0.3s;}
    .summary-card:hover{transform: translateY(-5px);}
    .summary-card h3{font-size:16px;color:#817979;margin-bottom:10px;}
    .summary-card p{font-size:22px;font-weight:700;}

    /* Order History */
    .order-history{background:#fff;padding:20px;border-radius:12px;box-shadow:0 6px 20px rgba(0,0,0,0.08);}
    .order-history h2{margin-bottom:16px;color:#817979;}
    .order-item{border:1px solid #eee;border-radius:8px;padding:14px;margin-bottom:12px;cursor:pointer;transition:all 0.3s;}
    .order-item:hover{background:#fef0f0;box-shadow:0 4px 15px rgba(0,0,0,0.05);}
    .order-header{display:flex;justify-content:space-between;font-weight:600;}
    .order-details{display:none;margin-top:10px;}
    .order-details p{margin:5px 0;font-size:14px;}

    @media(max-width:700px){
      .profile-details{grid-template-columns:1fr;}
      .summary{flex-direction:column;}
    }
  </style>
</head>
<body>
  <div class="container">
    <!-- Profile Header -->
    <div class="profile-header">
      <div class="avatar" id="avatar">U</div>
      <div class="profile-info">
        <h1 id="greeting">Welcome, User</h1>
        <p id="userEmailHeader">Email: —</p>
        <div class="buttons">
          <button class="btn btn-primary" onclick="window.location.href='cart.html'">View Cart</button>
          <button class="btn btn-secondary" id="logoutBtn">Logout</button>
        </div>
      </div>
    </div>

    <!-- Profile Details -->
    <div class="profile-details">
      <div class="detail-card"><strong>Name</strong><span id="userName">—</span></div>
      <div class="detail-card"><strong>Email</strong><span id="userEmail">—</span></div>
      <div class="detail-card"><strong>Phone</strong><span id="userPhone">—</span></div>
      <div class="detail-card"><strong>Gender</strong><span id="userGender">—</span></div>
      <div class="detail-card"><strong>Country/State</strong><span id="userLocation">—</span></div>
      <div class="detail-card"><strong>Joined</strong><span id="userJoined">—</span></div>
    </div>

    <!-- Summary -->
    <div class="summary">
      <div class="summary-card">
        <h3>Total Orders</h3>
        <p id="totalOrders">0</p>
      </div>
      <div class="summary-card">
        <h3>Total Spent (₦)</h3>
        <p id="totalSpent">0</p>
      </div>
    </div>

    <!-- Order History -->
    <div class="order-history">
      <h2>Order History</h2>
      <div id="orderHistory"><p>No orders yet.</p></div>
    </div>
  </div>

  <script>
    const loggedInUser = JSON.parse(sessionStorage.getItem('loggedInUser')) || JSON.parse(localStorage.getItem('loggedInUser'));
    if(!loggedInUser){ window.location.href='login.html'; }

    // Fill profile
    document.getElementById('greeting').textContent = 'Welcome, ' + (loggedInUser.fullname || 'User');
    document.getElementById('userEmailHeader').textContent = 'Email: ' + (loggedInUser.email || '—');
    document.getElementById('avatar').textContent = loggedInUser.fullname ? loggedInUser.fullname.charAt(0).toUpperCase() : 'U';
    document.getElementById('userName').textContent = loggedInUser.fullname || '—';
    document.getElementById('userEmail').textContent = loggedInUser.email || '—';
    document.getElementById('userPhone').textContent = loggedInUser.phone || '—';
    document.getElementById('userGender').textContent = loggedInUser.gender || '—';
    document.getElementById('userLocation').textContent = (loggedInUser.country || '') + (loggedInUser.state ? ' / ' + loggedInUser.state : '');
    document.getElementById('userJoined').textContent = loggedInUser.createdAt ? new Date(loggedInUser.createdAt).toLocaleString() : '—';

    // Logout
    document.getElementById('logoutBtn').addEventListener('click', ()=>{
      sessionStorage.removeItem('loggedInUser');
      localStorage.removeItem('loggedInUser');
      window.location.href='login.html';
    });

    // Orders
    const orders = JSON.parse(localStorage.getItem('orders')) || [];
    const userOrders = orders.filter(o=>o.userEmail===loggedInUser.email);
    document.getElementById('totalOrders').textContent = userOrders.length;
    const totalSpent = userOrders.reduce((sum, o)=> sum + o.total,0);
    document.getElementById('totalSpent').textContent = totalSpent.toLocaleString();

    // Render order history
    const orderHistoryElem = document.getElementById('orderHistory');
    if(userOrders.length>0){
      orderHistoryElem.innerHTML='';
      userOrders.forEach((order,idx)=>{
        const div = document.createElement('div');
        div.className='order-item';
        div.innerHTML = `
          <div class="order-header">
            <span>Order ${idx+1} - ${new Date(order.date).toLocaleString()}</span>
            <span>Total: ₦${order.total.toLocaleString()}</span>
          </div>
          <div class="order-details">
            ${order.items.map(it=>`<p>${it.name} × ${it.quantity} - ₦${it.price.toLocaleString()}</p>`).join('')}
          </div>
        `;
        div.addEventListener('click', ()=>{
          const details = div.querySelector('.order-details');
          details.style.display = details.style.display==='block'?'none':'block';
        });
        orderHistoryElem.appendChild(div);
      });
    }
  </script>
</body>
</html>
